# IOC

#### 1 谈谈对Spring IoC的了解？

**回答方式**：思想、解释控制反转、传统的和IoC对比、理解。

Ioc，Inverse of Control，控制反转，是一种**解耦**的设计思想，而不是具体的技术实现。IoC的思想就是将原本在程序中手动创建对象的控制权，交由Spring框架来管理。底层实现：工厂设计模式。

> 传统Java SE程序设计，直接在对象内部通过new进行创建对象，是程序主动创建依赖对象。而Ioc是专门一个容器来控制这些对象，即有IoC容器来控制对象的创建。

**为什么叫控制反转？**

控制：对象创建（实例化、管理、成员变量赋值）的权利。

反转：控制权交给外部环境（Spring框架、IoC容器）

![img](https://raw.githubusercontent.com/zouquchen/Images/main/imgs/frc-365faceb5697f04f31399937c059c162.png)

> 何为正转呢，有我们自己主动控制去直接获取依赖对象。

将对象之间的相互依赖关系交给IoC容器管理，并由IoC容器完成对象的注入，简化应用的开发。**IoC容器就像一个工厂，当需要创建一个对象时，只需要配置号配置文件/注解即可，完全不用考虑对象时如何被创建出来的。**

**控制反转怎么理解？**

对象a依赖对象b，当对象a需要使用对象b的时候必须自己去创建。当系统引入IOC容器后，对象a和对象b之间就失去了直接的联系。这个时候，当对象a需要使用对象b的时候，我们可以指定IOC容器去创建一个对象b注入到对象a中。对象a获得对象b的过程，由主动行为变为被动行为，控制权反转，这就是控制反转名字的由来。



> 提到IOC首先想到的两个字是容器，就是用来装对象的容器，这个容器应该是个Map。
>
> 对象如何创建呢？通过工厂模式反射创建对象。
>
> 通过bean的定义信息（注解或xml）的方式告诉spring，这个对象需要被spring容器创建。
>
> 在Spring框架中有BeanDefinition就是bean的定义信息。

#### 2 依赖注入

DI（dependency Inject，依赖注入）是实现控制反转的一种设计模式，依赖注入就是实例变量传入到一个对象中去。

IOC是一种思想，DI是一种具体的技术手段。

IoC是站在对象的角度上，对象的实例化以及管理从程序员手里交给了IoC容器。

DI是站在容器的角度上，把对象的依赖的其他对象注入到容器中。

主要有三种注入方式：

1. 构造器注入：

   被注入对象可以在它的构造方法中声明依赖对象的参数列表，让外部知道它需要哪些依赖对象。然后，IoC会检查被注入对象的构造方法，取得它所需要的依赖对象列表，进而为其注入相应的对象。构造方法注入比较直观，对象被构造完后，即进入就绪状态，可以马上使用。

2. setter方法注入：

   通过setter方法，可以更改相应的对象属性。所以，当前对象只要为其依赖对象所对应的属性添加setter方法，就可以通过setter方法将相应的依赖对象设置到被注入对象中。setter方法注入虽不像构造方法注入那样，让对象构造完成后即可使用，但相对来说更宽松一些。

3. 接口注入：

   被注入对象如果想要IoC为其注入依赖对象，就必须实现某个接口。这个接口提供一个方法，用来为其注入依赖对象。IoC最终通过这些接口来了解应该为被注入对象注入什么依赖对象。