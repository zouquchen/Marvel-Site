---
title: 五层网络模型
date: 2022-07-13 19:16:45
permalink: /pages/03aafd/
categories:
  - 计算机基础
  - 计算机网络
tags:
  - 
author: 
  name: Marvel
  link: https://github.com/zouquchen
---
#### 1 网络分层结构？

OSI七层、TCP/IP四层、五层模型，以五层模型为例：

- 应用层：提供两个终端设备上的**应用程序**之间信息交换的服务，它定义了信息**交换的格式**，消息会交给传输层来传输。在互联网中的应用层协议很多，如DNS、HTTP、SMTP等。
- 传输层：负责向两台终端设备**进程**之间的通信提供通用的**数据传输服务**。传输控制协议TCP（面向连接、可靠）、用户数据协议UDP（无连接，不保证数据传输的可靠性）。
- 网络层：两个计算机之间有很多链路和网络，网络层的任务就是**选择不同的节点或链路确保数据及时传送**。包括IP协议。
- 数据链路层：在**两个相邻节点之间传输数据**时，将网络层交下来的IP数据报组装成帧，在两个相邻节点间的链路上传帧。
- 物理层：实现相邻节点间比特流的透明传输，尽可能屏蔽传输介质和物理设备的差异。

TCP/IP网络结构

- 应用层
- 传输层
- 网络层
- 网络接口层（数据链路层、物理层）



#### 2 应用层

主要提供**两台终端设备**上的**应用程序**之间信息交互的服务，它定义了信息交换的格式，消息会交给下一层传输层来传输。我们把应用层交互的数据单元称为报文。

![img](https://raw.githubusercontent.com/zouquchen/Images/main/imgs/5971-2-7I1-20220111095024771-20220111201807861.png)

应用层协议定义了网路通信规则，对于不同的网络应用需要不同的应用层协议。Web应用HTTP协议，支持电子邮件的SMTP协议等等。

#### 3 传输层

负责向**两台终端设备进程**之间的通信提供通用的数据传输服务。应用进程利用该服务传送应用层报文。“通用的”是指并不针对某一个特定的网络应用，而是多种应用可以使用同一个运输层服务。

主要使用以下两个协议：

- 传输控制协议TCP，Transmission Control Protocal，提供面向连接的，可靠的数据传输服务。
- 用户数据协议UDP，User Datagram Protocal，提供无连接的，不保证数据传输可靠性的，尽最大努力的数据传输服务。

#### 4 网络层

在计算机网络进行通信的两个计算机之间可能会经过多个数据链路，也可能还要经过很多通信子网。**网络层的任务就是选择合适的网络路由和交换节点，确保数据及时传送。**在发生数据时，网络层把运输层产生的报文段或用户数据报封装成分组和包进行传输。网络层还有一个任务就是选择合适的路由，使源主机运输层传下来的分组，能通过网络层中的路由器找到目的主机。

在TCP/IP体系结构中，由于网络层使用IP协议，因此分组也叫IP数据报，简称数据报。

注意：不要把运输层的用`户数据报UDP`和网络层的`IP数据报`弄混。

> 网络层是由大量的异构网络通过路由器相互连接起来的。互联网使用的网络层协议是无连接的网际协议和许多路由选择协议，因此互联网的网络层也叫做**网际层**或**IP层**。

#### 5 网络接口层

网络接口层是数据链路层和物理层的合体。

1. 数据链路层：将网络层交下来的IP数据包组装成帧，在两个相邻节点间的链路上传输帧。每一帧包括数据和必要的控制信息。
2. 物理层：实现相邻节点间比特流的透明传输，尽可能屏蔽传输介质和物理设备的差异。

#### 1 网络层与数据链路层有什么关系？

- IP在网络层，MAC在数据链路层。
- MAC的作用是实现【直连】的两个设备之间通讯，而IP则负责在【没有直连】的两个网络之间进行传输。
- 比如，小林要去很远的地方旅行，制定了一个行程表，期间需要先后乘坐飞机、地铁、公交车才能到达目的地，为此小林需要买飞机票、地铁票等；飞机票、地铁票都是去往特定的地点，每张票只能在某一协定区间内移动，此处的【区间内】就如同通信网络中数据链路；
- 在区间内移动相当于数据链路层，充当区间内两个节点传输的功能，区间内的出发点好比源MAC地址，目标地点好比目的MAC地址。
- 整个旅游行程表相当于网络层，充当远程定位的功能，行程的开始好比源IP，行程的终点好比目的IP地址。
- <img src="https://raw.githubusercontent.com/zouquchen/Images/main/imgs/image-20220221161731642.png" alt="image-20220221161731642" style="zoom:67%;" />
- 如果小林只有行程表而没有车票，就无法搭乘交通工具到达目的地。相反，如果有车票而没有行程表，恐怕也很难到达目的地。
- 因此，计算机网络中也需要【数据链路层】和【网络层】这个分层才能实现向最终目标地址的通信。
- 旅程中虽然交通工具在不断的变化，但是旅行行程的起始地址和目的地址都没有变。源IP地址和目标IP地址在传输过程中是不会变化的，只有源MAC地址和目标MAC一直变化。

#### 2 IP地址分类

- 五类IP地址：A、B、C、D、E，黄色部分为分类号，用以区分IP地址类别。

- <img src="https://raw.githubusercontent.com/zouquchen/Images/main/imgs/image-20220221162720979.png" alt="image-20220221162720979" style="zoom:50%;" />

- A、B、C类主要分为两部分：网络和和主机号。最大主机数为：
  $$
  2^{主机号}-2
  $$

- 主机号全为1：指定某个网络下的所有主机，用于广播；主机号全为0指定某个网络。因此最大主机数要减2.

- 广播地址用于在同一个链路中互相连接的主机之间发送数据包。例如`172.20.0.0/16`广播地址为`172.20.255.255`

- 在本网络内广播的叫本地广播，网络地址`192.168.0.0/24`，广播地址为`192.168.0.255`，因为这个广播地址的IP包会被路由器屏蔽，所以不会到达`192.168.0.0/24`以外的其他链路上。

- 在不同网络之间的广播叫直接广播，网络地址`192.168.0.0/24`的主机向`192.168.1.255/24`的目标地址发送IP包，收到这个包的路由器将数据发给`192.168.1.0/24`，从而使得广播地址为`192.168.1.1`~`192.168.1.254`的主机都能收到这个包。

#### 3 为什么要分离网络和和主机号？

因为两台计算机要通讯，首先要判断是否处于同一个广播域内，即网络号是否相同。如果网络地址相同，表明接收方在本地网络上，那么可以把数据包直接发送给目标主机。